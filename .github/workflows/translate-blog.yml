name: Translate blog to uk/pl/ru

on:
  push:
    branches: [ main ]
    paths:
      - "index.html"
      - "posts/**"
  workflow_dispatch: {}

jobs:
  translate-and-sync:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout English source repo
        uses: actions/checkout@v4
        with:
          fetch-depth: 1

      - name: Setup Python
        uses: actions/setup-python@v5
        with:
          python-version: "3.11"

      - name: Install dependencies
        run: |
          pip install requests

      - name: Translate and push to language repos
        env:
          GH_BOT_TOKEN: ${{ secrets.DEVLAB }}          
          OPENAI_API_KEY: ${{ secrets.OPENAI_API_KEY }}

          REPO_UK: "MiaGorceva/devlab-blog"
          REPO_PL: "MiaGorceva/devlab-blog.pl"
          REPO_RU: "MiaGorceva/devlab-blog.ru"

          OPENAI_MODEL: "gpt-4o-mini"

        run: |
          python .github/scripts/translate_and_push.py
